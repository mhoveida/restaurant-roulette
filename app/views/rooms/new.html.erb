<% content_for :body_class, "bg-black" %>

<div class="create-room-container" data-controller="create-room">
  <h1 class="create-room-title">Create a Group Room</h1>

  <% if flash[:alert].present? %>
    <div class="alert alert-danger">
      <%= flash[:alert] %>
    </div>
  <% end %>

  <!-- Preference Form Section -->
  <div class="preference-section">
    <h2>Coordinate with your friends</h2>
    <p class="subtitle">Set your group's preferences</p>

    <%= form_with(url: rooms_path, method: :post, local: true, data: { action: "submit->create-room#onSubmit" }) do |form| %>
      <div class="form-group">
        <label for="owner_name">Name</label>
        <%= form.text_field :owner_name,
            value: @owner_name,
            placeholder: "Your name",
            readonly: current_user.present?,
            data: { 'create-room-target': 'ownerNameInput' } %>
      </div>

      <!-- Location Dropdown -->
      <div class="form-group">
        <label for="location">Neighborhood</label>
        <%= form.select :location,
            [],
            { include_blank: "Select a neighborhood" },
            { data: { 'create-room-target': 'locationSelect' }, class: 'neighborhood-select' } %>
        <small style="color: rgba(255, 255, 255, 0.5); display: block; margin-top: 0.5rem; font-size: 0.85rem;">
          üìç Choose where you want to eat
        </small>
      </div>

      <div class="form-group">
        <label for="price">Price Range</label>
        <%= form.select :price,
            [['Select price range', ''], ['$', '$'], ['$$', '$$'], ['$$$', '$$$'], ['$$$$', '$$$$']],
            { selected: @price },
            { data: { 'create-room-target': 'priceSelect' } } %>
      </div>

      <!-- Cuisines Multi-Select -->
      <div class="form-group">
        <label>Cuisines <small style="color: rgba(255, 255, 255, 0.5);">(Select at least one)</small></label>
        <div class="cuisines-grid" data-create-room-target="cuisinesGrid">
          <!-- Will be populated by JavaScript -->
          <div style="color: rgba(255, 255, 255, 0.5); padding: 1rem;">Loading cuisines...</div>
        </div>
        <!-- Hidden field to store selected cuisines -->
        <input type="hidden" name="categories" data-create-room-target="categoriesInput">
      </div>

      <div class="button-group">
        <%= form.submit "Create Room", class: "button create-button", data: { 'create-room-target': 'createButton', action: 'click->create-room#validateAndCreate' } %>
      </div>

      <div class="validation-message" data-create-room-target="validationMessage" style="display: none;">
        Please fill in all required fields
      </div>
    <% end %>
  </div>
</div>