<% content_for :body_class, "bg-black" %>

<div class="create-room-container" data-controller="create-room">
  <h1 class="create-room-title">Create a Group Room</h1>

  <!-- Preference Form Section -->
  <div class="preference-section">
    <h2>Coordinate with your friends</h2>
    <p class="subtitle">Set your group's preferences</p>

    <%= form_with(url: rooms_path, method: :post, local: true, data: { action: "submit->create-room#onSubmit" }) do |form| %>
      <div class="form-group">
        <label for="owner_name">Name</label>
        <%= form.text_field :owner_name,
            value: @owner_name,
            placeholder: "Your name",
            readonly: current_user.present?,
            data: { 'create-room-target': 'ownerNameInput' } %>
        <% if @room && @room.errors[:owner_name].present? %>
          <span class="error-message"><%= @room.errors[:owner_name].join(', ') %></span>
        <% end %>
      </div>

      <div class="form-group">
        <label for="location">Location</label>
        <div class="location-input-wrapper">
          <%= form.text_field :location,
              value: @location,
              placeholder: "Enter location",
              data: { 'create-room-target': 'locationInput', 'action': 'input->create-room#onLocationChange' } %>
          <span class="location-icon">üìç</span>
        </div>
        <div class="location-suggestions" data-create-room-target="suggestions" style="display: none;"></div>
        <% if @room && @room.errors[:location].present? %>
          <span class="error-message"><%= @room.errors[:location].join(', ') %></span>
        <% end %>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="price">Price Range</label>
          <%= form.select :price,
              [['Select price range', ''], ['$', '$'], ['$$', '$$'], ['$$$', '$$$'], ['$$$$', '$$$$']],
              { selected: @price },
              { data: { 'create-room-target': 'priceSelect' } } %>
          <% if @room && @room.errors[:price].present? %>
            <span class="error-message"><%= @room.errors[:price].join(', ') %></span>
          <% end %>
        </div>

        <div class="form-group">
          <label for="categories">Cuisine Preferences</label>
          <%= form.text_field :categories,
              value: @categories,
              placeholder: "e.g., Italian, American",
              data: { 'create-room-target': 'cuisineInput', 'action': 'input->create-room#onCuisineChange' } %>
          <div class="cuisine-tags" data-create-room-target="cuisineTags"></div>
          <% if @room && @room.errors[:categories].present? %>
            <span class="error-message"><%= @room.errors[:categories].join(', ') %></span>
          <% end %>
        </div>
      </div>

      <div class="button-group">
        <%= form.submit "Create Room", class: "button create-button", data: { 'create-room-target': 'createButton', action: 'click->create-room#validateAndCreate' } %>
      </div>

      <div class="validation-message" data-create-room-target="validationMessage" style="display: none;">
        Please fill in all required fields
      </div>
    <% end %>
  </div>
</div>
